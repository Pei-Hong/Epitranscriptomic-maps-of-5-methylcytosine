 awk '{if($7!=$8) {split($10, start, ","); split($11, end, ","); for(i=1; i< length(start); i++) {if(end[i] > $7 && end[i] < $8){ if(start[i]<=$7) {print $3"\t"$7"\t"end[i]"\tcds\t0\t"$4"\t"$1} else {print $3"\t"start[i]"\t"end[i]"\tcds\t0\t"$4"\t"$1}} else if(start[i] <$7 && end[i] >=$8){ print $3"\t"$7"\t"$8"\tcds\t0\t"$4"\t"$1} else if(end[i]>= $8 && start[i]< $8) print $3"\t"start[i]"\t"$8"\tcds\t0\t"$4"\t"$1} }}'  /picb/rnomics4/peihong/0_script/software/genome/hg38.txt > /picb/rnomics4/peihong/0_script/software/genome/genome_region/cds.txt
 awk '{split($10, start, ","); split($11, end, ","); for(i=1; i< (length(start)-1); i++) {print $3"\t"end[i]"\t"start[i+1]"\tintron\t0\t"$4"\t"$1}}'  /picb/rnomics4/peihong/0_script/software/genome/hg38.txt > /picb/rnomics4/peihong/0_script/software/genome/genome_region/intron.txt
 awk '{if($7==$8) {split($10, start, ","); split($11, end, ","); for(i=1; i< length(start); i++) {print $3"\t"start[i]"\t"end[i]"\tnoncoding\t0\t"$4"\t"$1}} }'  /picb/rnomics4/peihong/0_script/software/genome/hg38.txt > /picb/rnomics4/peihong/0_script/software/genome/genome_region/noncoding.txt
 awk '{if($7!=$8 && $4 == "+") {split($10, start, ","); split($11, end, ","); for(i=1; i < length(start); i++) {if(end[i] > $8 && start[i] <= $8) print $3"\t"$8"\t"end[i]"\t3utr\t0\t"$4"\t"$1; else if(end[i] > $8 && start[i] > $8) print $3"\t"start[i]"\t"end[i]"\t3utr\t0\t"$4"\t"$1}} else if($7!=$8 && $4 == "-") {split($10, start, ","); split($11, end, ","); for(i=1; i < length(start); i++) {if(start[i] < $7 && end[i] < $7) print $3"\t"start[i]"\t"end[i]"\t3utr\t0\t"$4"\t"$1; else if(start[i] < $7 && end[i] >=$7) print $3"\t"start[i]"\t"$7"\t3utr\t0\t"$4"\t"$1 }}}'  /picb/rnomics4/peihong/0_script/software/genome/hg38.txt > /picb/rnomics4/peihong/0_script/software/genome/genome_region/3utr.txt
 awk '{if($7!=$8 && $4 == "+") {split($10, start, ","); split($11, end, ","); for(i=1; i < length(start); i++) {if(start[i] < $7 && end[i] < $7) print $3"\t"start[i]"\t"end[i]"\t5utr\t0\t"$4"\t"$1; else if(start[i] < $7 && end[i] >=$7) print $3"\t"start[i]"\t"$7"\t5utr\t0\t"$4"\t"$1} } else if($7 !=$8 && $4 == "-") {split($10, start, ","); split($11, end, ",");  for(i=1; i < length(start); i++) {if(end[i] > $8 && start[i] <= $8) print $3"\t"$8"\t"end[i]"\t5utr\t0\t"$4"\t"$1; else if(end[i] > $8 && start[i] >$8) print $3"\t"start[i]"\t"end[i]"\t5utr\t0\t"$4"\t"$1}}}'  /picb/rnomics4/peihong/0_script/software/genome/hg38.txt > /picb/rnomics4/peihong/0_script/software/genome/genome_region/5utr.txt
